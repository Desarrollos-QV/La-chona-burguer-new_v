{"version":3,"file":"src_app_account_address_address_module_ts.js","mappings":"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","sources":["./src/app/account/address/address.module.ts","./src/app/account/address/address.page.ts"],"sourcesContent":["import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { AddressPage } from './address.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: AddressPage\n  }\n];\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    RouterModule.forChild(routes)\n  ],\n  declarations: [AddressPage]\n})\nexport class AddressPageModule {}\n","import { Component, ViewChild, ElementRef,OnInit } from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\nimport { ServerService } from '../../service/server.service';\nimport { ToastController,NavController,LoadingController  } from '@ionic/angular';\nimport { Geolocation } from '@ionic-native/geolocation/ngx';\nimport { NativeGeocoder, NativeGeocoderResult, NativeGeocoderOptions } from '@ionic-native/native-geocoder/ngx';\nimport { mapStyle } from '../../service/mapStyle.js';\n\ndeclare var google:any;\n\n\n@Component({\n  selector: 'app-address',\n  templateUrl: './address.page.html',\n  styleUrls: ['./address.page.scss'],\n})\n\nexport class AddressPage implements OnInit {\n\n@ViewChild('map',{static:false}) mapElement: ElementRef;\n  \n  map: any;\n  lat: any;\n  lng: any;\n  location:any;\n  address:string;\n  type_add:any;\n  text:any;\n  marker: any;\n  constructor(\n\n    public route: ActivatedRoute,\n    public server : ServerService,\n    public toastController: ToastController,\n    public nav: NavController,\n    public loadingController: LoadingController,\n    public geolocation: Geolocation,\n    public nativeGeocoder: NativeGeocoder\n    ){\n    this.text = JSON.parse(localStorage.getItem('app_text'));\n    this.route.queryParams.subscribe( params => {\n      this.location = JSON.parse(params.location);\n      this.lat      = this.location.lat;\n      this.lng      = this.location.lng;\n      this.address = params.address;\n    }); \n  }\n\n  ngOnInit()\n  {\n    setTimeout(() => {\n      this.loadMap();\n    }, 800);\n   \n  }\n\n \n  async loadMap() {\n    const loading = await this.loadingController.create({});\n    await loading.present();\n\n    let latLng = new google.maps.LatLng(this.lat, this.lng);\n    let mapOptions = {\n      center: latLng,\n      zoom: 15,\n      disableDefaultUI: true,\n      mapTypeId: google.maps.MapTypeId.ROADMAP,\n      styles: mapStyle\n    }\n    \n    this.map = new google.maps.Map(this.mapElement.nativeElement, mapOptions);\n\n    this.marker = new google.maps.Marker({\n      map: this.map,\n      draggable:true,\n      position:latLng\n    });\n    this.marker.setVisible(true);\n\n    this.getAddressFromCoords(this.lat,this.lng);\n \n    google.maps.event.addListener(this.marker, 'dragend', (evt) => {\n      this.getAddressFromCoords(evt.latLng.lat(),evt.latLng.lng());\n    });\n    loading.dismiss();\n  }\n \n  async getAddressFromCoords(lattitude, longitude) {\n    var geocoder = new google.maps.Geocoder;\n    let $this = this;\n    let options: NativeGeocoderOptions = {\n      useLocale: true,\n      maxResults: 5\n    };\n \n    this.nativeGeocoder.reverseGeocode(lattitude, longitude, options)\n      .then((result: NativeGeocoderResult[]) => {\n        this.address = \"\";\n\n        let responseAddress = [];\n        for (let [key, value] of Object.entries(result[0])) {\n  \n          if(value.length > 0)\n          responseAddress.push(value);\n \n        }\n\n        responseAddress.reverse();\n        for (let value of responseAddress) {\n          this.address += value+\", \";\n        }\n        this.address = this.address.slice(0, -2);\n      })\n      .catch((error: any) =>{ \n        let add = document.getElementById('addressPWA');\n        var latlng = {lat: parseFloat(lattitude), lng: parseFloat(longitude)};\n        let responseAddress = [];\n        geocoder.geocode({'location': latlng}, function(result, status) {\n          if (status === 'OK') {\n          \n            $this.address = \"\";\n\n            for (let [key, value] of Object.entries(result[0])) {\n              responseAddress.push(value); \n            }\n            \n            responseAddress.reverse();\n            \n            for (let value of responseAddress) {\n              $this.address += value+\", \";\n            }\n            \n            $this.address = responseAddress[4];\n          } else {\n            console.log('Geocoder failed due to: ' + status);\n          }\n        });\n      });\n \n  }\n\n  async saveAddress(data)\n  {\n    const loading = await this.loadingController.create({\n      message: 'Porfavor espere...',\n    });\n    await loading.present();\n \n    if (localStorage.getItem('user_id')) {\n      var allData = {\n        address : this.address,\n        type    : this.type_add,\n        lat     : this.map.center.lat(),\n        lng     : this.map.center.lng(),\n        user_id : localStorage.getItem('user_id')\n      }\n\n      this.server.saveAddress(allData).subscribe((response:any) => {\n        if (response.msg == 'done') {\n          localStorage.setItem(\"address\",this.address);\n          localStorage.setItem('address_id',response.id);\n          localStorage.setItem(\"current_lat\",this.map.center.lat());\n          localStorage.setItem('current_lng',this.map.center.lng());\n          \n          this.nav.navigateForward('home');\n          this.presentToast(\"Dirección guardada con éxito.\",'success');  \n        }else {\n          this.presentToast(JSON.stringify(response.data),'danger');  \n        }\n        \n        loading.dismiss();\n        \n      });\n    }else {\n      localStorage.setItem(\"address\",this.address);\n      localStorage.setItem('address_id',\"0\");\n      localStorage.setItem(\"current_lat\",this.map.center.lat());\n      localStorage.setItem('current_lng',this.map.center.lng());\n        \n      this.nav.navigateForward('home');\n      this.presentToast(\"Dirección guardada con éxito.\",'success');\n      loading.dismiss();\n    }\n  }\n\n  async presentToast(txt,color) {\n    const toast = await this.toastController.create({\n      message: txt,\n      duration: 3000,\n      position : 'top',\n      mode:'ios',\n      color:color\n    });\n    toast.present();\n  }\n}\n"],"names":[],"sourceRoot":"webpack:///"}