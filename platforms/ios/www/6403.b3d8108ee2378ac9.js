"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6403],{6403:(G,f,r)=>{r.r(f),r.d(f,{DonePageModule:()=>z});var h=r(9808),_=r(3075),Z=r(3697),i=r(3349),p=r(655),T=r(1169),t=r(5e3),y=r(6419),x=r(7618),A=r(1084);const I=["map"],P=["directionsPanel"];function O(o,n){1&o&&(t.TgZ(0,"p",20),t._uU(1,"Pedido realizado con \xe9xito. Esperando confirmaci\xf3n del restaurante"),t.qZA())}function U(o,n){1&o&&(t.TgZ(0,"p",20),t._uU(1,"Orden confirmada. Tu comida est\xe1 siendo preparada."),t.qZA())}function q(o,n){1&o&&(t.TgZ(0,"p",20),t._uU(1,"Buscando Socio Repartidor"),t.qZA())}function C(o,n){1&o&&(t.TgZ(0,"p",20),t._uU(1,"Orden confirmada. Tu comida est\xe1 siendo preparada, Se te notificar\xe1 cuando est\xe9 lista"),t.qZA())}function D(o,n){1&o&&(t.TgZ(0,"p",20),t._uU(1,"Tu orden est\xe1 lista para recoger"),t.qZA())}function M(o,n){1&o&&(t.TgZ(0,"p",20),t._uU(1,"Se ha asignado un repartidor a tu pedido."),t.qZA())}function S(o,n){1&o&&(t.TgZ(0,"p",20),t._uU(1,"Tu Orden esta en ruta!!"),t.qZA())}function b(o,n){if(1&o&&(t.TgZ(0,"div",21),t._UZ(1,"div",22,23),t.TgZ(3,"p"),t._uU(4),t.qZA(),t.qZA()),2&o){const e=t.oxw();t.xp6(4),t.Oqu(e.address)}}function w(o,n){if(1&o&&(t.TgZ(0,"ion-item"),t._UZ(1,"ion-icon",24),t.TgZ(2,"ion-label"),t._uU(3,"Buscando Socio Repartidor"),t.qZA(),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("color",e.getColor(1.5)),t.xp6(1),t.ekj("light",e.status<1.5)}}function Q(o,n){if(1&o&&(t.TgZ(0,"ion-item"),t._UZ(1,"ion-icon",25),t.TgZ(2,"ion-label"),t._uU(3,"Repartidor asignado"),t.qZA(),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("color",e.getColor(3)),t.xp6(1),t.ekj("light",e.status<3)}}function Y(o,n){if(1&o&&(t.TgZ(0,"ion-item"),t._UZ(1,"ion-icon",26),t.TgZ(2,"ion-label"),t._uU(3,"Orden recogida"),t.qZA(),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("color",e.getColor(4)),t.xp6(1),t.ekj("light",e.status<4)}}function J(o,n){if(1&o&&(t.TgZ(0,"ion-item"),t._UZ(1,"ion-icon",27),t.TgZ(2,"ion-label"),t._uU(3,"Listo para recoger"),t.qZA(),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("color",e.getColor(7)),t.xp6(1),t.ekj("light",e.type<7)}}const k=[{path:"",component:(()=>{class o{constructor(e,a,s,g,c,u,l){this.toastController=e,this.nav=a,this.server=s,this.geolocation=g,this.nativeGeocoder=c,this.renderer=u,this._document=l,this.status=0,this.progress=.016,this.chargeMap=!1,this.km_h=50}ngOnInit(){this.data=JSON.parse(localStorage.getItem("order_data")),this.text=JSON.parse(localStorage.getItem("app_text")),this.currency=this.data.currency,this.data=this.data.data,this.getStatus(),this.Interval_1=setInterval(()=>{this.progress=.016,this.getStatus()},4e3),this.Intervarl_2=setInterval(()=>{this.progress=1*this.progress+.016},6e3)}getStatus(){this.server.getStatus(this.data.id).subscribe(e=>{this.status=e.data.status,this.type=e.data.type,4==this.status&&(localStorage.setItem("lat_dboy",e.dboy.lat),localStorage.setItem("lng_dboy",e.dboy.lng),0==this.chargeMap?(this.chargeMap=!0,this.loadMap()):this.ViewdBoy()),2==this.status&&(this.presentToast("\xa1Lo siento! Su pedido ha sido cancelado."),this.nav.navigateRoot("order"),clearInterval(this.Interval_1),clearInterval(this.Intervarl_2)),5==this.status&&(this.presentToast("Pedido entregado con \xe9xito"),localStorage.removeItem("menu_item"),localStorage.removeItem("order_data"),clearInterval(this.Interval_1),clearInterval(this.Intervarl_2),this.nav.navigateRoot(1==this.type?"rate/"+this.data.id+"/staff":"rate/"+this.data.id+"/store"))})}getColor(e){if(1==e&&this.status<1)return"medium";if(1.5==e){if(this.status<1.5)return"medium"}else if(3==e){if(this.status<3)return"medium"}else if(4==e){if(this.status<4)return"medium"}else if(7==e&&this.type<7)return"medium";return"primary"}loadMap(){return(0,p.mG)(this,void 0,void 0,function*(){console.log(this.status);let e=localStorage.getItem("lat_dboy"),a=localStorage.getItem("lng_dboy");this.getAddressFromCoords(e,a);const s={url:"assets/d.png",scaledSize:new google.maps.Size(50,50)};let g=new google.maps.LatLng(e,a),c={center:g,zoom:15,disableDefaultUI:!0,mapTypeId:google.maps.MapTypeId.ROADMAP,styles:T.U};this.map=new google.maps.Map(this.mapElement.nativeElement,c),google.maps.event.addListenerOnce(this.map,"idle",()=>{this.marker=new google.maps.Marker({position:g,map:this.map,icon:s,title:this.address})})})}ViewdBoy(){return(0,p.mG)(this,void 0,void 0,function*(){let e=localStorage.getItem("lat_dboy"),a=localStorage.getItem("lng_dboy");this.getAddressFromCoords(e,a);let s=new google.maps.LatLng(e,a);this.map.setCenter(s),this.marker.setPosition(s)})}getAddressFromCoords(e,a){return(0,p.mG)(this,void 0,void 0,function*(){let s=this;var g=new google.maps.Geocoder;this.nativeGeocoder.reverseGeocode(e,a,{useLocale:!0,maxResults:5}).then(u=>{this.address="";let l=[];for(let[d,m]of Object.entries(u[0]))m.length>0&&l.push(m);l.reverse();for(let d of l)this.address+=d+", ";this.address=this.address.slice(0,-2)}).catch(u=>{var l={lat:parseFloat(e),lng:parseFloat(a)};let d=[];g.geocode({location:l},function(m,v){if("OK"===v){for(let[F,N]of Object.entries(m[0]))d.push(N);d.reverse(),s.address=d[4]}else console.log(v)})})})}presentToast(e){return(0,p.mG)(this,void 0,void 0,function*(){(yield this.toastController.create({message:e,duration:3e3,position:"top",mode:"ios",color:"dark"})).present()})}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(i.yF),t.Y36(i.SH),t.Y36(y.N),t.Y36(x.b),t.Y36(A.d),t.Y36(t.Qsj),t.Y36(h.K0))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-done"]],viewQuery:function(e,a){if(1&e&&(t.Gf(I,5),t.Gf(P,5)),2&e){let s;t.iGM(s=t.CRH())&&(a.mapElement=s.first),t.iGM(s=t.CRH())&&(a.directionsPanel=s.first)}},decls:44,vars:18,consts:[["no-border",""],["color","primary"],["slot","start","routerLink","/home","routerDirection","root"],["name","home",2,"font-size","29px"],["slot","end"],["fill","outline","mode","ios","size","small","routerLink","/order","routerDirection","forward"],["mode","ios"],[2,"width","100%","background-color","#FF0017","height","80px","color","white"],["mode","ios",1,"welcome-card",2,"margin-top","-15%","background-color","white","width","98%","margin-left","1%"],["name","restaurant"],[1,"ion-padding"],["style","font-size: 12px",4,"ngIf"],["class","map-wrapper",4,"ngIf"],["buffer","0.5",3,"value"],["mode","ios",1,"welcome-card",2,"width","98%","margin-left","1%"],["lines","none"],["routerLink","/order","routerDirection","forward"],["slot","start","color","primary","name","cart"],["slot","start","name","checkmark-circle",3,"color"],[4,"ngIf"],[2,"font-size","12px"],[1,"map-wrapper"],["id","map"],["map",""],["slot","start","name","search",3,"color"],["slot","start","name","link",3,"color"],["slot","start","name","bus",3,"color"],["slot","start","name","walk",3,"color"]],template:function(e,a){1&e&&(t.TgZ(0,"ion-header",0),t.TgZ(1,"ion-toolbar",1),t.TgZ(2,"ion-buttons",2),t._UZ(3,"ion-icon",3),t.qZA(),t.TgZ(4,"ion-buttons",4),t.TgZ(5,"ion-button",5),t._uU(6,"View Order Detail"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(7,"ion-content",6),t.TgZ(8,"div",7),t._uU(9,"\xa0"),t.qZA(),t.TgZ(10,"ion-card",8),t.TgZ(11,"ion-card-header"),t.TgZ(12,"ion-card-title"),t._uU(13),t.qZA(),t.TgZ(14,"ion-card-subtitle"),t._UZ(15,"ion-icon",9),t._uU(16),t.qZA(),t.qZA(),t.qZA(),t.TgZ(17,"div",10),t.YNc(18,O,2,0,"p",11),t.YNc(19,U,2,0,"p",11),t.YNc(20,q,2,0,"p",11),t.YNc(21,C,2,0,"p",11),t.YNc(22,D,2,0,"p",11),t.YNc(23,M,2,0,"p",11),t.YNc(24,S,2,0,"p",11),t.YNc(25,b,5,1,"div",12),t._UZ(26,"ion-progress-bar",13),t.qZA(),t.TgZ(27,"ion-card",14),t.TgZ(28,"ion-card-header"),t.TgZ(29,"ion-card-title"),t._uU(30,"Order Status"),t.qZA(),t.qZA(),t.TgZ(31,"ion-list",15),t.TgZ(32,"ion-item",16),t._UZ(33,"ion-icon",17),t.TgZ(34,"ion-label"),t._uU(35,"Pedido realizado"),t.qZA(),t.qZA(),t.TgZ(36,"ion-item"),t._UZ(37,"ion-icon",18),t.TgZ(38,"ion-label"),t._uU(39,"Orden confirmada"),t.qZA(),t.qZA(),t.YNc(40,w,4,3,"ion-item",19),t.YNc(41,Q,4,3,"ion-item",19),t.YNc(42,Y,4,3,"ion-item",19),t.YNc(43,J,4,3,"ion-item",19),t.qZA(),t.qZA(),t.qZA()),2&e&&(t.xp6(13),t.Oqu(a.text.confirm_title),t.xp6(3),t.hij(" ",a.data.store,""),t.xp6(2),t.Q6J("ngIf",0==a.status),t.xp6(1),t.Q6J("ngIf",1==a.status&&1==a.type),t.xp6(1),t.Q6J("ngIf",1.5==a.status&&1==a.type),t.xp6(1),t.Q6J("ngIf",1==a.status&&2==a.type),t.xp6(1),t.Q6J("ngIf",1==a.status&&7==a.type),t.xp6(1),t.Q6J("ngIf",3==a.status),t.xp6(1),t.Q6J("ngIf",4==a.status),t.xp6(1),t.Q6J("ngIf",4==a.status),t.xp6(1),t.s9C("value",a.progress),t.xp6(11),t.Q6J("color",a.getColor(1)),t.xp6(1),t.ekj("light",a.status<1),t.xp6(2),t.Q6J("ngIf",1==a.type),t.xp6(1),t.Q6J("ngIf",1==a.type),t.xp6(1),t.Q6J("ngIf",1==a.type),t.xp6(1),t.Q6J("ngIf",1!=a.type))},directives:[i.Gu,i.sr,i.Sm,i.YI,Z.rH,i.gu,i.YG,i.W2,i.PM,i.Zi,i.Dq,i.tO,h.O5,i.X7,i.q_,i.Ie,i.Q$],styles:["ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{font-size:12px}ion-item[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:12px;color:gray;margin-right:10%}ion-content[_ngcontent-%COMP%]{--background:#f9f8f8}.light[_ngcontent-%COMP%]{color:gray}#map_canvas[_ngcontent-%COMP%]{width:90%;height:60%;border:1px solid red}#address[_ngcontent-%COMP%]{padding:10px;font-size:18px;font-weight:700}#map[_ngcontent-%COMP%]{width:100%;height:60vh}.map-wrapper[_ngcontent-%COMP%]{position:relative}.map-wrapper[_ngcontent-%COMP%]   #map_center[_ngcontent-%COMP%]{position:absolute;z-index:99;height:60px;width:60px;top:50%;left:50%}"]}),o})()}];let z=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[h.ez,_.u5,i.Pc,Z.Bz.forChild(k)]]}),o})()}}]);