{"version":3,"file":"src_app_account_address_setaddress_setaddress_module_ts.js","mappings":"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","sources":["./src/app/account/address/setaddress/setaddress-routing.module.ts","./src/app/account/address/setaddress/setaddress.module.ts","./src/app/account/address/setaddress/setaddress.page.ts"],"sourcesContent":["import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { SetaddressPage } from './setaddress.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: SetaddressPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class SetaddressPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { SetaddressPageRoutingModule } from './setaddress-routing.module';\n\nimport { SetaddressPage } from './setaddress.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    SetaddressPageRoutingModule\n  ],\n  declarations: [SetaddressPage]\n})\nexport class SetaddressPageModule {}\n","import { Component, OnInit, NgZone } from '@angular/core';\nimport { LoadingController, NavController, Platform, ToastController } from '@ionic/angular';\nimport { ServerService } from '../../../service/server.service';\nimport { Geolocation } from '@ionic-native/geolocation/ngx';\nimport { NativeGeocoder, NativeGeocoderResult, NativeGeocoderOptions } from '@ionic-native/native-geocoder/ngx';\nimport { NavigationExtras } from '@angular/router';\ndeclare var google;\n \n\n\n@Component({\n  selector: 'app-setaddress',\n  templateUrl: './setaddress.page.html',\n  styleUrls: ['./setaddress.page.scss'],\n})\nexport class SetaddressPage implements OnInit {\n  \n  data:any;\n  admin:any;\n  searchQuery: any;\n  hasSearch:any;\n  address:any;\n  LocationNow:any;\n  MyLocation = [];\n  GoogleAutocomplete: any;\n  autocomplete: { input: string; };\n  autocompleteItems: any[];\n  lat:any = localStorage.getItem('current_lat') ? localStorage.getItem('current_lat') : 0;\n  lng:any = localStorage.getItem('current_lng') ? localStorage.getItem('current_lng') : 0;\n  \n  constructor(\n    public server: ServerService,\n    public toastController: ToastController,\n    public geolocation: Geolocation,\n    public nativeGeocoder: NativeGeocoder,\n    public zone: NgZone,\n    public nav: NavController,\n    public loadingController: LoadingController,\n    public platform: Platform\n  ) { \n    \n  }\n\n  ngOnInit() {\n  }\n\n  ionViewWillEnter()\n  {   \n     \n      this.admin = JSON.parse(localStorage.getItem('admin'));\n      this.autocomplete = { input: '' };\n      this.searchQuery = null;\n      this.hasSearch   = false;\n      this.autocompleteItems = [];\n      \n      this.platform.ready().then( () => {\n        if (google) {\n          this.loadData();     \n        }\n      });\n  }\n\n  loadData()\n  {\n    this.server.getAllAdress(localStorage.getItem('user_id')).subscribe((response:any) => {\n      this.address = response.data;\n    });\n\n     // Obtenemos la ubicación actual\n     this.geolocation.getCurrentPosition().then((resp) => {\n      this.lat = resp.coords.latitude;\n      this.lng = resp.coords.longitude;\n      this.getAddressFromCoords(resp.coords.latitude, resp.coords.longitude);\n    }).catch((error) => {\n      console.log('Error al obtener la ubicación', error);\n    });\n  }\n\n  getAddressFromCoords(lattitude, longitude) {\n\n    this.server.GeocodeFromCoords(lattitude, longitude,this.admin.ApiKey_google).subscribe((data:any) => {\n      let formatted_address = data.results[0].formatted_address;\n      this.LocationNow = formatted_address;\n      this.MyLocation.push({\n        \"lat\"          : data.results[0].geometry.location.lat,\n        \"lng\"          : data.results[0].geometry.location.lng,\n        \"address\"      : this.LocationNow\n      }); \n    });\n   \n  }\n\n  search(ev)\n  {\n    this.GoogleAutocomplete = new google.maps.places.AutocompleteService();\n\n    var val = ev.target.value;\n    if(val && val.length > 0)\n    {\n      this.data      = null;\n      this.hasSearch = val;\n      if (this.autocomplete.input == '') {\n        this.autocompleteItems = [];\n        return;\n      }\n      this.GoogleAutocomplete.getPlacePredictions({ input: this.autocomplete.input },\n      (predictions, status) => {\n        this.autocompleteItems = [];\n        this.zone.run(() => {\n          predictions.forEach((prediction) => {\n            this.autocompleteItems.push(prediction);\n          });\n        });\n      });\n    }\n    else\n    {\n      this.ngOnInit();\n      this.hasSearch = false;\n    }\n  }\n  \n  clearSearch() {\n    this.searchQuery = null;\n    this.hasSearch   = false;\n    this.autocompleteItems = [];\n  }\n\n  SelectSearchResult(item)\n  {\n    var geocoder = new google.maps.Geocoder;\n    let $this = this;\n    let options: NativeGeocoderOptions = {\n      useLocale: true,\n      maxResults: 2\n    };\n\n    geocoder.geocode({'placeId': item.place_id}, function(results, status) {\n      if (status !== 'OK') {\n        window.alert('Geocoder failed due to: ' + status);\n        return;\n      }\n      let navigationExtras: NavigationExtras = {\n        queryParams: {\n          location: JSON.stringify(results[0].geometry.location),\n          address: item.description\n        }\n      };\n  \n      $this.nav.navigateForward(['/address'], navigationExtras);\n      \n    });\n  }\n  \n  removeAddress(id) {\n    this.server.trashAddress(id).subscribe(data => {\n        if (data) {\n          this.presentToast(\"La dirección se ha eliminado...\",'success');\n          this.ionViewWillEnter();\n        }else {\n          this.presentToast(data,'danger');\n        }\n    });\n  }\n\n  async saveAddress(item,type)\n  {\n    const loading = await this.loadingController.create({\n      message: 'Guardando Dirección...',\n    });\n    await loading.present();\n\n    if (type == 'LocationNow') {\n      var allData = {\n        address : item.address,\n        lat : this.lat,\n        lng : this.lng,\n        user_id : localStorage.getItem('user_id')\n      }  \n\n      this.server.saveAddress(allData).subscribe((response:any) => {\n        if (response.msg == 'done') {\n          localStorage.setItem(\"address\",item.address,);\n          localStorage.setItem('address_id',response.id);\n          localStorage.setItem(\"current_lat\",this.lat);\n          localStorage.setItem('current_lng',this.lng);\n        \n          this.nav.navigateForward('home');\n          this.presentToast(\"Dirección guardada con éxito.\",'success');  \n        }else {\n          this.presentToast(JSON.stringify(response.data),'danger');  \n        }\n        \n        loading.dismiss();\n      });\n    }else{\n      localStorage.setItem(\"address\",item.address);\n      localStorage.setItem('address_id',item.id);\n      localStorage.setItem(\"current_lat\",item.lat);\n      localStorage.setItem('current_lng',item.lng);\n        \n      this.nav.navigateForward('home');\n      this.presentToast(\"Dirección guardada con éxito.\",'success');\n      loading.dismiss();\n    }\n    \n  }\n\n  async presentToast(txt,color) {\n    const toast = await this.toastController.create({\n      message: txt,\n      duration: 2000,\n      position : 'top',\n      color:color\n    });\n    toast.present();\n  }\n\n  \n\n}\n"],"names":[],"sourceRoot":"webpack:///"}